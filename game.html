<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kode Ceria: Petualangan Logika</title>
    <style>
        /* --- TEMA: CANDY / FUN --- */
        :root {
            --bg-gradient: linear-gradient(120deg, #a1c4fd 0%, #c2e9fb 100%);
            --panel: #ffffff;
            --primary: #ff9a9e; /* Pink Pastel */
            --primary-dark: #ff6b6b;
            --accent: #fbc2eb; /* Ungu Muda */
            --success: #84fab0; /* Hijau Mint */
            --text-main: #555;
            --text-light: #888;
            --font-fun: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; padding: 0;
            background-image: var(--bg-gradient);
            color: var(--text-main);
            font-family: var(--font-fun);
            height: 100vh;
            display: flex;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        /* --- ANIMASI BACKGROUND LUCU (Doodles) --- */
        .bg-doodles {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            overflow: hidden;
            z-index: 1;
            pointer-events: none;
        }
        .doodle {
            position: absolute;
            bottom: -50px;
            font-size: 2rem;
            opacity: 0.6;
            animation: floatUp 10s linear infinite;
        }
        .d1 { left: 10%; animation-duration: 8s; animation-delay: 0s; }
        .d2 { left: 30%; animation-duration: 12s; animation-delay: 2s; }
        .d3 { left: 70%; animation-duration: 7s; animation-delay: 5s; }
        .d4 { left: 90%; animation-duration: 11s; animation-delay: 1s; }

        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.6; }
            100% { transform: translateY(-110vh) rotate(360deg); opacity: 0; }
        }

        /* --- CONTAINER UTAMA --- */
        #app-container {
            width: 100%;
            max-width: 480px;
            height: 100%;
            background: rgba(255, 255, 255, 0.85); /* Putih Transparan */
            backdrop-filter: blur(10px);
            position: relative;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
            z-index: 10;
        }

        /* --- SCREENS --- */
        .screen {
            flex: 1;
            display: none;
            flex-direction: column;
            padding: 25px;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Efek Bouncy */
        }
        .screen.active { display: flex; }

        @keyframes popIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        /* --- COMPONENTS --- */
        h1 { color: var(--primary-dark); font-size: 2rem; text-align: center; margin-bottom: 10px; font-weight: 800; letter-spacing: -1px;}
        p { text-align: center; color: var(--text-light); line-height: 1.6; }

        .btn {
            background: white;
            border: none;
            color: var(--text-main);
            padding: 15px;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 50px; /* Tombol Bulat */
            cursor: pointer;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05), 0 4px 0 #eee; /* Efek 3D Halus */
            transition: all 0.2s;
            width: 100%;
            position: relative;
            top: 0;
        }
        .btn:active { top: 4px; box-shadow: 0 2px 0 #eee; }
        
        .btn-primary { background: var(--primary); color: white; box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3), 0 4px 0 var(--primary-dark); }
        .btn-primary:active { box-shadow: 0 2px 0 var(--primary-dark); }

        .btn-danger { background: #ffbe76; color: white; box-shadow: 0 4px 0 #f0932b; }

        /* --- MAP GRID (Card Style) --- */
        .level-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            overflow-y: auto;
            padding: 10px 5px;
        }
        .level-card {
            background: white;
            padding: 20px;
            border-radius: 20px;
            text-align: center;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            transition: 0.2s;
        }
        .level-card.locked { opacity: 0.5; filter: grayscale(100%); }
        .level-card.unlocked { border: 3px solid var(--primary); transform: scale(1.05); }
        .level-card.completed { background: var(--success); color: white; }
        
        .level-icon { font-size: 2rem; display: block; margin-bottom: 5px; }

        /* --- GAMEPLAY --- */
        .hud {
            background: white;
            padding: 15px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .heart-bar { color: #ff6b6b; font-size: 1.2rem; }
        
        .question-box {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .code-snippet {
            background: #f4f7f6;
            color: #333;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 15px 0;
            border-left: 5px solid var(--primary);
        }

        /* --- POPUP MODAL --- */
        .modal {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            text-align: center;
            padding: 30px;
        }
        .modal-icon { font-size: 5rem; margin-bottom: 20px; animation: bounce 1s infinite; }
        
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

    </style>
</head>
<body>

<!-- ANIMATED BACKGROUND -->
<div class="bg-doodles">
    <div class="doodle d1">‚òÅÔ∏è</div>
    <div class="doodle d2">üíª</div>
    <div class="doodle d3">ü§ñ</div>
    <div class="doodle d4">‚≠ê</div>
</div>

<div id="app-container">

    <!-- 1. HOME SCREEN -->
    <div id="screen-home" class="screen active">
        <div style="flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center;">
            <div style="font-size: 6rem; margin-bottom:10px;">üêº</div>
            <h1>Kode Ceria</h1>
            <p>Belajar Koding jadi lebih asik!<br>Bantu Panda memecahkan teka-teki logika.</p>
            <br>
            <button class="btn btn-primary" onclick="app.showScreen('map')">MULAI PETUALANGAN</button>
            <button class="btn btn-danger" onclick="app.resetProgress()">ULANG DARI AWAL</button>
        </div>
    </div>

    <!-- 2. MAP SCREEN -->
    <div id="screen-map" class="screen">
        <div style="text-align:center; margin-bottom:20px;">
            <h2>Peta Dunia</h2>
            <small style="color:var(--primary-dark)">Pilih level untuk bermain</small>
        </div>
        <div class="level-grid" id="level-container">
            <!-- Level cards generated by JS -->
        </div>
        <button class="btn" style="margin-top:auto" onclick="app.showScreen('home')">üè† Kembali</button>
    </div>

    <!-- 3. GAMEPLAY SCREEN -->
    <div id="screen-game" class="screen">
        <div class="hud">
            <div class="heart-bar" id="hp-display">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
            <div style="font-weight:bold; color:var(--primary)">Soal <span id="q-counter">1</span>/10</div>
        </div>

        <div id="game-content" style="flex:1; overflow-y:auto;">
            <div class="question-box">
                <div id="q-text" style="font-weight:bold; font-size:1.1rem; margin-bottom:10px;">Loading...</div>
                <div id="q-code" class="code-snippet"></div>
            </div>
            <div id="q-options"></div>
        </div>
        
        <button class="btn btn-danger" onclick="app.quitLevel()">üè≥Ô∏è Menyerah</button>
    </div>

    <!-- FEEDBACK MODAL -->
    <div id="modal-feedback" class="modal">
        <div class="modal-icon" id="fb-icon">üéâ</div>
        <h2 id="fb-title">HEBAT!</h2>
        <p id="fb-desc">Jawaban kamu benar.</p>
        <button class="btn btn-primary" id="fb-btn">LANJUT</button>
    </div>

</div>

<script>
// --- DATA SOAL (Sama seperti sebelumnya, tapi bisa diedit bahasanya biar lebih santai) ---
const GAME_DB = {
    level1: [
        { q: "Haii! Mau menampilkan tulisan 'Halo' di Python, pakai perintah apa?", code: "", opts: ["print('Halo')", "show('Halo')", "say('Halo')", "text('Halo')"], a: 0, exp: "Betul! Fungsi print() gunanya mencetak tulisan ke layar." },
        { q: "Kalau x = 5, berarti x itu jenis datanya apa?", code: "x = 5", opts: ["Tulisan (String)", "Angka Bulat (Integer)", "Angka Koma (Float)", "Benar/Salah (Boolean)"], a: 1, exp: "Integer adalah sebutan keren untuk bilangan bulat." },
        { q: "Coba tebak, kode ini hasilnya True atau False?", code: "a = 10\nb = 5\nprint(a > b)", opts: ["True (Benar)", "False (Salah)", "Error", "Tidak Tahu"], a: 0, exp: "10 kan lebih besar dari 5, jadi jawabannya True!" },
        { q: "Mana cara bikin teks (String) yang benar?", code: "", opts: ["nama = 'Panda'", "nama = Panda", "nama = [Panda]", "nama : Panda"], a: 0, exp: "Ingat ya, teks harus selalu dijepit tanda kutip '...' atau \"...\"" },
        { q: "Tanda pagar '#' dipakai buat apa sih?", code: "# Ini kode rahasia", opts: ["Bikin Variabel", "Komentar (Catatan)", "Hapus Data", "Bikin Judul"], a: 1, exp: "Komentar itu cuma catatan buat programmer, komputer bakal cuekin baris ini." },
        { q: "Sisa bagi dari 10 dibagi 3 berapa hayo?", code: "print(10 % 3)", opts: ["3", "1", "0", "2"], a: 1, exp: "10 dibagi 3 itu dapat 3, sisanya 1. Simbol % itu namanya Modulus." },
        { q: "Mau bikin keranjang belanja (List) kosong, caranya?", code: "", opts: ["keranjang = []", "keranjang = {}", "keranjang = ()", "keranjang = list"], a: 0, exp: "List di Python selalu pakai kurung siku [ ]." },
        { q: "Kalau AI dikasih kunci jawaban buat belajar, namanya apa?", code: "", opts: ["Supervised Learning", "Unsupervised Learning", "Magic Learning", "Self Study"], a: 0, exp: "Supervised artinya 'diawasi' atau dikasih contekan jawaban biar pinter." },
        { q: "Alat (Library) Python paling hits buat bikin AI?", code: "", opts: ["TensorFlow", "Ms Word", "Photoshop", "Excel"], a: 0, exp: "TensorFlow itu library buatan Google buat bikin otak buatan." },
        { q: "Apa jadinya kalau teks ditambah teks?", code: "print('Aku' + 'Pintar')", opts: ["AkuPintar", "Aku Pintar", "Error", "Aku+Pintar"], a: 0, exp: "Di dunia koding, tanda + buat teks itu artinya 'digandeng' tanpa spasi." }
    ]
};

// --- APP LOGIC (Updated for LocalStorage Safety) ---
const app = {
    levels: 10,
    progress: 1,
    
    init: function() {
        try {
            const saved = localStorage.getItem('kc_progress');
            if(saved) this.progress = parseInt(saved);
        } catch(e) { console.log("Mode Tanpa Simpan"); }
        this.renderMap();
    },

    showScreen: function(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById('screen-' + id).classList.add('active');
        if(id === 'map') this.renderMap();
    },

    renderMap: function() {
        const container = document.getElementById('level-container');
        container.innerHTML = '';
        const topics = ["Pemula", "Logika", "Looping", "Fungsi", "Data", "Algoritma", "Intro AI", "Data AI", "Robot", "Tamat"];

        for (let i = 1; i <= this.levels; i++) {
            let status = 'locked';
            if (i < this.progress) status = 'completed';
            else if (i === this.progress) status = 'unlocked';

            const div = document.createElement('div');
            div.className = `level-card ${status}`;
            // Icon berbeda tiap status
            let icon = status === 'locked' ? 'üîí' : (status === 'completed' ? '‚≠ê' : 'üöÄ');
            
            div.innerHTML = `
                <span class="level-icon">${icon}</span>
                <div style="font-weight:bold; font-size:1.2rem;">Level ${i}</div>
                <div style="font-size:0.8rem; margin-top:5px;">${topics[i-1]}</div>
            `;
            
            if(status !== 'locked') {
                div.onclick = () => game.start(i);
            }
            container.appendChild(div);
        }
    },

    saveProgress: function(lvl) {
        if (lvl >= this.progress && this.progress < this.levels) {
            this.progress++;
            try { localStorage.setItem('kc_progress', this.progress); } catch(e){}
        }
    },

    resetProgress: function() {
        if(confirm("Yakin mau mulai dari nol lagi?")) {
            try { localStorage.removeItem('kc_progress'); } catch(e){}
            this.progress = 1;
            location.reload();
        }
    },

    quitLevel: function() {
        if(confirm("Mau nyerah dan kembali ke peta?")) {
            this.showScreen('map');
        }
    }
};

const game = {
    level: 1,
    qIndex: 0,
    hp: 4,
    data: [],

    start: function(lvl) {
        this.level = lvl;
        this.qIndex = 0;
        this.hp = 4; // Nyawa berbentuk hati
        this.generateQuestions(lvl);
        app.showScreen('game');
        this.updateHUD();
        this.renderQuestion();
    },

    generateQuestions: function(lvl) {
        if (lvl === 1) this.data = GAME_DB.level1;
        else {
            // Generator Soal Otomatis (Dummy)
            this.data = [];
            for(let i=0; i<10; i++) {
                let n1 = Math.floor(Math.random()*10);
                let n2 = Math.floor(Math.random()*10);
                let isTrue = n1 > n2;
                this.data.push({
                    q: `Tantangan Level ${lvl}: Apakah ${n1} lebih besar dari ${n2}?`,
                    code: `print(${n1} > ${n2})`,
                    opts: ["True", "False"],
                    a: isTrue ? 0 : 1,
                    exp: `Karena ${n1} ${isTrue ? 'memang' : 'tidak'} lebih besar dari ${n2}.`
                });
            }
        }
    },

    renderQuestion: function() {
        const q = this.data[this.qIndex];
        document.getElementById('q-text').innerText = q.q;
        
        const codeEl = document.getElementById('q-code');
        if(q.code) {
            codeEl.style.display = 'block';
            codeEl.innerText = q.code;
        } else codeEl.style.display = 'none';

        const optsContainer = document.getElementById('q-options');
        optsContainer.innerHTML = '';
        q.opts.forEach((opt, idx) => {
            let btn = document.createElement('button');
            btn.className = 'btn';
            btn.innerText = opt;
            btn.onclick = () => this.checkAnswer(idx);
            optsContainer.appendChild(btn);
        });
    },

    checkAnswer: function(idx) {
        const q = this.data[this.qIndex];
        const modal = document.getElementById('modal-feedback');
        const icon = document.getElementById('fb-icon');
        const title = document.getElementById('fb-title');
        const desc = document.getElementById('fb-desc');
        const btn = document.getElementById('fb-btn');

        modal.style.display = 'flex';

        if(idx === q.a) {
            icon.innerText = "üéâ";
            title.innerText = "YEY BENAR!";
            title.style.color = "var(--success)";
            desc.innerText = q.exp;
            btn.className = "btn btn-primary";
            btn.innerText = "LANJUT";
            btn.onclick = () => {
                modal.style.display = 'none';
                this.qIndex++;
                if(this.qIndex >= 10) this.finishLevel();
                else {
                    this.updateHUD();
                    this.renderQuestion();
                }
            }
        } else {
            this.hp--;
            icon.innerText = "üò≠";
            title.innerText = "YAHH SALAH...";
            title.style.color = "#ff6b6b";
            desc.innerText = "Jawaban kurang tepat. Coba lagi ya!";
            this.updateHUD();

            if(this.hp <= 0) {
                btn.className = "btn btn-danger";
                btn.innerText = "ULANG LEVEL";
                btn.onclick = () => {
                    modal.style.display = 'none';
                    this.start(this.level);
                }
            } else {
                btn.className = "btn";
                btn.innerText = "COBA LAGI";
                btn.onclick = () => modal.style.display = 'none';
            }
        }
    },

    updateHUD: function() {
        let hearts = "";
        for(let i=0; i<4; i++) hearts += (i < this.hp ? "‚ù§Ô∏è" : "ü§ç");
        document.getElementById('hp-display').innerText = hearts;
        document.getElementById('q-counter').innerText = this.qIndex + 1;
    },

    finishLevel: function() {
        app.saveProgress(this.level);
        document.getElementById('fb-icon').innerText = "üèÜ";
        document.getElementById('fb-title').innerText = "LEVEL SELESAI!";
        document.getElementById('fb-desc').innerText = "Kamu hebat banget! Level berikutnya terbuka.";
        document.getElementById('fb-btn').innerText = "KE PETA";
        document.getElementById('fb-btn').onclick = () => {
             document.getElementById('modal-feedback').style.display = 'none';
             app.showScreen('map');
        };
        document.getElementById('modal-feedback').style.display = 'flex';
    }
};

app.init();
</script>

</body>
</html>
